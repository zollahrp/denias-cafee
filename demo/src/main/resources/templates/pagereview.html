<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary meta tags -->
    <title>Review</title>
    <!-- Title of the webpage -->
    <meta name="title" content="Denias Cafe" />
    <!-- Meta title for SEO -->
    
    <!-- Favicon -->
    <!--<link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml">  Link to favicon -->

    <!-- Google Font Link -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;700&family=Forum&display=swap"
      rel="stylesheet"
    />
    <!-- ALERT -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Custom CSS link -->
    <link rel="stylesheet" th:href="@{/assets/css/pagereview.css}" />
    <!-- Link to custom CSS file -->

    <!-- Preload images for performance optimization -->
    <link rel="preload" as="image" th:href="@{/assets/images/hero-slider-1.jpg}" />
    <link rel="preload" as="image" th:href="@{/assets/images/hero-slider-2.jpg}" />
    <link rel="preload" as="image" th:href="@{/assets/images/hero-slider-3.jpg}" />

    <link rel="icon" type="image/svg+xml" th:href="@{/assets/img/favicon.svg}">

</head>

  <body id="top">
    <!-- Preloader untuk halaman web-->
    <div class="preload" data-preaload>
      <div class="circle"></div>
      <p class="text">Denias Cafe</p>
    </div>

    <!-- TOP BAR -->
    <div class="topbar">
      <div class="container">
        <address class="topbar-item">
          <div class="icon">
            <ion-icon name="location-outline" aria-hidden="true"></ion-icon>
          </div>
          <span class="span" th:text="#{topbar.location_id}"></span>
        </address>

        <div class="separator"></div>

        <div class="topbar-item item-2">
          <div class="icon">
            <ion-icon name="time-outline" aria-hidden="true"></ion-icon>
          </div>
          <span class="span" th:text="#{topbar.opening_hours_id}"></span>
        </div>

        <a href="tel:+6281355906775" class="topbar-item link">
          <div class="icon">
            <ion-icon name="call-outline" aria-hidden="true"></ion-icon>
          </div>
          <span class="span" th:text="#{topbar.phone_id}"></span>
        </a>

        <div class="separator"></div>

        <a href="mailto:deniascafe@gmail.com" class="topbar-item link">
          <div class="icon">
            <ion-icon name="mail-outline" aria-hidden="true"></ion-icon>
          </div>
          <span class="span" th:text="#{topbar.email_id}"></span>
        </a>

        <!-- Language Selector -->
        <div class="topbar-item">
          <a href="?lang=id" class="btn btn-primary">Indonesia</a>
          <a href="?lang=en" class="btn btn-secondary">English</a>
        </div>
      </div>
    </div>

    <!-- HEADER -->
    <header class="header" data-header>
      <div class="container">
        <a href="/home" class="logo">
          <img
            src="./assets/img/Logo.svg"
            width="160"
            height="50"
            alt="Denias Cafe - Home"
          />
        </a>
        <nav class="navbar" data-navbar>
          <button class="close-btn" aria-label="close menu" data-nav-toggler>
            <ion-icon name="close-outline" aria-hidden="true"></ion-icon>
          </button>
          <a href="/home" class="logo">
            <img
              src="./assets/img/Logo.svg"
              width="160"
              height="50"
              alt="Denias Cafe - Home"
            />
          </a>
          <!-- Navbar -->
          <ul class="navbar-list">
            <li class="navbar-item">
              <a href="/" class="navbar-link hover-underline">
                <div class="separator"></div>
                <span class="span" th:text="#{navbar.home_id}"></span>
              </a>
            </li>

            <li class="navbar-item">
              <a href="/menu" class="navbar-link hover-underline">
                <div class="separator"></div>
                <span class="span" th:text="#{navbar.menu_id}"></span>
              </a>
            </li>

            <li class="navbar-item">
              <a href="/aboutus" class="navbar-link hover-underline">
                <div class="separator"></div>
                <span class="span" th:text="#{navbar.aboutus_id}"></span>
              </a>
            </li>

            <li class="navbar-item">
              <a href="/pagereview" class="navbar-link hover-underline active">
                <div class="separator"></div>
                <span class="span" th:text="#{navbar.review_id}"></span>
              </a>
            </li>

            <li class="navbar-item">
              <a href="/contact" class="navbar-link hover-underline">
                <div class="separator"></div>
                <span class="span" th:text="#{navbar.contact_id}"></span>
              </a>
            </li>
          </ul>

      <!--Navbar di HP-->
      <div class="text-center">
        <p class="headline-1 navbar-title" th:text="#{navbar.visit_us_id}"></p>

        <address class="body-4">
          <span th:text="#{navbar.address_id}"></span> <br>
        </address>

        <p class="body-4 navbar-text" th:text="#{navbar.opening_hours_id}"></p>
  <a href="mailto:deniascafe@gmail.com" class="body-4 sidebar-link" th:text="#{navbar.email_id}"></a>
  <div class="separator"></div>
  <p class="contact-label" th:text="#{navbar.booking_request_id}"></p>
  <a href="tel:+6281355906775" class="body-1 contact-number hover-underline" th:text="#{navbar.phone_id}"></a>
      </div>

    </nav>

    <a href="https://wa.me/+6281355906775" class="btn btn-secondary">
      <span class="text text-1" th:text="#{navbar.book_table_id}"></span>
      <span class="text text-2" aria-hidden="true" th:text="#{navbar.book_table_id}"></span>
    </a>

    <button class="nav-open-btn" aria-label="open menu" data-nav-toggler>
      <span class="line line-1"></span>
      <span class="line line-2"></span>
      <span class="line line-3"></span>
    </button>

    <div class="overlay" data-nav-toggler data-overlay></div>

  </div>
    </header>

    <!--CONTACT-->

    <!-- ===== BOX ICONS ===== -->
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />

   <!--===== CONTACT ME =====-->
<section class="contact section bd-container" id="contact">
    <br /><br /><br /><br /><br />
    
  
<!-- REVIEW -->
<br />
<span class="section-subtitle">Review</span>
<div class="contact__container bd-grid">
  <ul class="feedback centered">
    <li class="angry" data-text="angry">
      <div>
        <svg class="eye left"><use xlink:href="#eye"></use></svg>
        <svg class="eye right"><use xlink:href="#eye"></use></svg>
        <svg class="mouth"><use xlink:href="#mouth"></use></svg>
      </div>
    </li>
    <li class="sad" data-text="sad">
      <div>
        <svg class="eye left"><use xlink:href="#eye"></use></svg>
        <svg class="eye right"><use xlink:href="#eye"></use></svg>
        <svg class="mouth"><use xlink:href="#mouth"></use></svg>
      </div>
    </li>
    <li class="ok" data-text="ok">
      <div></div>
    </li>
    <li class="good active" data-text="good">
      <div>
        <svg class="eye left"><use xlink:href="#eye"></use></svg>
        <svg class="eye right"><use xlink:href="#eye"></use></svg>
        <svg class="mouth"><use xlink:href="#mouth"></use></svg>
      </div>
    </li>
    <li class="happy" data-text="happy">
      <div>
        <svg class="eye left"><use xlink:href="#eye"></use></svg>
        <svg class="eye right"><use xlink:href="#eye"></use></svg>
      </div>
    </li>
  </ul>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 4" id="eye">
      <path d="M1,1 C1.83333333,2.16666667 2.66666667,2.75 3.5,2.75 C4.33333333,2.75 5.16666667,2.16666667 6,1"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 7" id="mouth">
      <path d="M1,5.5 C3.66666667,2.5 6.33333333,1 9,1 C11.6666667,1 14.3333333,2.5 17,5.5"></path>
    </symbol>
  </svg>
  <!-- END OF REVIEW -->
  <!--RATA RATA-->
  <section class="contact section bd-container" id="contact">
    <div class="contact__container bd-grid">
        <div id="dominant-emoji-container" class="centered">
            <h1>Rata-Rata Kepuasan Pelanggan:</h1>
            <div id="dominant-emoji" class="emoji"></div>
        </div>
    </div>
  </section>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        fetch('/api/getDominantEmoji')
            .then(response => response.json())
            .then(data => {
                const container = document.getElementById('dominant-emoji-container');
                const emoji = data.dominantEmoji;
                const emojiMap = {
                    'angry': 'üò†',
                    'sad': 'üò¢',
                    'ok': 'üòê',
                    'good': 'üòä',
                    'happy': 'üòÑ'
                };
                const emojiDisplay = emojiMap[emoji] || 'No reviews yet';
  
                container.innerHTML = `<h1>Rata-Rata Kepuasan Pelanggan: ${emojiDisplay}</h1>`;
            })
            .catch(error => console.error('Error:', error));
    });
  </script>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.querySelectorAll('.feedback li').forEach(item => {
    // Event listener untuk hover
    item.addEventListener('mouseenter', event => {
      const text = item.getAttribute('data-text');
      item.setAttribute('title', text);
    });

    // Event listener untuk klik
    item.addEventListener('click', event => {
      const text = item.getAttribute('data-text');

      // Tampilkan notifikasi sukses langsung setelah klik
      Swal.fire({
        title: 'Review Terkirim!',
        text: 'Terimakasih telah memberikan review.',
        icon: 'success',
        confirmButtonText: 'OK'
      });

      // Kirim data review ke server
      fetch('/api/submitReview', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ review: text }),
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(data => {
        console.log('Success:', data);
      })
      .catch((error) => {
        console.error('Error:', error);
      });
    });
  });
</script>

      <br>
  
      <form id="contactForm" class="contact__form">
        <div class="contact__inputs">
          <input type="text" id="nama" placeholder="Nama" class="contact__input" />
        </div>
    
        <textarea id="komentar" cols="0" rows="7" placeholder="Pesan dan Kesan" class="contact__input"></textarea>
    
        <input type="submit" value="Kirim Pesan" class="button contact__button" />
      </form>
    
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <script>
        document.getElementById('contactForm').addEventListener('submit', function(event) {
          event.preventDefault();
          const nama = document.getElementById('nama').value;
          const komentar = document.getElementById('komentar').value;
    
          fetch('/api/pengguna/add', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `nama=${encodeURIComponent(nama)}&komentar=${encodeURIComponent(komentar)}`
          }).then(response => response.json())
            .then(data => {
              // Menampilkan notifikasi sukses dengan SweetAlert
              Swal.fire({
                title: 'Terimakasih!',
                text: 'Anda berhasil mengirimkan pesan/komentar.',
                icon: 'success',
                timer: 1500,
                showConfirmButton: false
              });
              // Reset form
              document.getElementById('contactForm').reset();
            }).catch(error => {
              console.error('Error:', error);
              // Menampilkan notifikasi error (opsional)
              Swal.fire({
                title: 'Error!',
                text: 'Terjadi kesalahan saat mengirimkan pesan/komentar.',
                icon: 'error',
                timer: 1500,
                showConfirmButton: false
              });
            });
        });
      </script>
    
    </div>
  </section>

  <main id="main" class="main">

    <div class="review-section">
      <div class="container">
        <div class="review">
          <h2 class="R-title">Review</h2>
          <div id="reviews" class="review-section"></div>
        </div>
      </div>
    </div>
    
    <script>
    fetch('/api/pengguna/all')
      .then(response => response.json())
      .then(data => {
        const reviewsContainer = document.getElementById('reviews');
        reviewsContainer.innerHTML = '';
        data.forEach(review => {
          const reviewElement = document.createElement('div');
          reviewElement.className = 'media media-review';
          reviewElement.innerHTML = `
            <div class="media-body">
              <div class="M-flex">
                <h2 class="title"><span>${review.namaPengguna}</span><span class="tglreview">${new Date(review.tanggalReview).toLocaleDateString('id-ID')}</span></h2>
              </div>
              <div class="description">${review.komentar}</div>
            </div>
          `;
          reviewsContainer.appendChild(reviewElement);
        });
      })
      .catch(error => console.error('Error:', error));
    </script>

</main>

    <!-- FOOTER -->
    <footer>
      <div class="row">
        <div class="col">
          <img src="./assets/img/Logo.svg" class="footer_logo" />
          <p
            class="footer_about"
            th:text="#{footer.welcome_message_id}"
          ></p>
        </div>
        <div class="col">
          <h3 th:text="#{footer.office_id}"></h3>
          <p th:text="#{footer.address1_id}"></p>
          <p th:text="#{footer.address2_id}"></p>
          <p th:text="#{footer.address3_id}"></p>
          <p class="footer_email" th:text="#{footer.email_id}"></p>
          <h4 th:text="#{footer.phone_id}"></h4>
        </div>
        <div class="col">
          <h3 th:text="#{footer.links_id}"></h3>
          <ul>
            <li><a href="/home" th:text="#{footer.home_id}"></a></li>
            <li><a href="/menu" th:text="#{footer.menu_id}"></a></li>
            <li>
              <a href="/aboutus" th:text="#{footer.aboutus_id}"></a>
            </li>
            <li>
              <a href="/pagereview" th:text="#{footer.review_id}"></a>
            </li>
            <li>
              <a href="/contact" th:text="#{footer.contact_id}"></a>
            </li>
          </ul>
        </div>
        <div class="col">
          <h3 th:text="#{footer.admin_id}"></h3>
          <button id="adminLoginButton">Admin Login</button>
          <div class="social_icons">
            <ion-icon
              class="social_icon"
              name="logo-whatsapp"
            ></ion-icon>
          </div>
        </div>
      </div>
      <hr />
      <p class="copyright" th:text="#{footer.copyright_id}"></p>
    </footer>

    <!-- 
    - #BACK TO TOP
  -->

    <a
      href="#top"
      class="back-top-btn active"
      aria-label="back to top"
      data-back-top-btn
    >
      <ion-icon name="chevron-up" aria-hidden="true"></ion-icon>
    </a>

    <!-- custom js link -->
    <script src="./assets/js/script.js"></script>
    <script src="./assets/js/kategori.js"></script>

    <!-- 
    - ionicon link
  -->
    <script
      type="module"
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
    ></script>
    <script>
      document.querySelectorAll(".feedback li").forEach((entry) =>
  entry.addEventListener("click", (e) => {
    if (!entry.classList.contains("active")) {
      document.querySelector(".feedback li.active").classList.remove("active");
      entry.classList.add("active");
    }
    e.preventDefault();
  })
);

    </script>

    <!--Swal notification-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!--VERIFIKASI-->
    <script>
      document.getElementById('adminLoginButton').addEventListener('click', function() {
          Swal.fire({
              title: 'Apakah Anda Pegawai Disini?',
              showDenyButton: true,
              confirmButtonText: 'Iya',
              denyButtonText: 'Tidak',
          }).then((result) => {
              if (result.isConfirmed) {
                  showVerificationModal();
              } else if (result.isDenied) {
                  window.location.href = '/home';
              }
          });
      });

      function showVerificationModal() {
          Swal.fire({
              title: 'Masukkan Kode Verifikasi',
              input: 'password',
              inputLabel: 'Kode Verifikasi',
              showCancelButton: true,
              confirmButtonText: 'Verifikasi',
              preConfirm: (code) => {
                  return fetch('/api/verify', {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/x-www-form-urlencoded',
                      },
                      body: new URLSearchParams({
                          'code': code
                      })
                  })
                  .then(response => response.text())
                  .then(data => {
                      if (data === 'Verifikasi berhasil!') {
                          Swal.fire({
                              title: 'Verifikasi berhasil!',
                              text: 'Anda akan diarahkan ke laman login',
                              icon: 'success',
                              confirmButtonText: 'OK'
                          }).then((result) => {
                              if (result.isConfirmed) {
                                  window.location.href = '/login';
                              }
                          });
                      } else {
                          Swal.fire({
                              title: 'Kode verifikasi salah',
                              text: 'Coba lagi.',
                              icon: 'error',
                              confirmButtonText: 'OK'
                          });
                      }
                  })
                  .catch(error => {
                      Swal.fire({
                          title: 'Terjadi kesalahan',
                          text: 'Coba lagi.',
                          icon: 'error',
                          confirmButtonText: 'OK'
                      });
                  });
              }
          });
      }
  </script>

  </body>
</html>
